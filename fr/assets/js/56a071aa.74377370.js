(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[5652],{3905:function(e,n,t){"use strict";t.d(n,{Zo:function(){return u},kt:function(){return p}});var s=t(7294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,s)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,s,a=function(e,n){if(null==e)return{};var t,s,a={},r=Object.keys(e);for(s=0;s<r.length;s++)t=r[s],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(s=0;s<r.length;s++)t=r[s],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var i=s.createContext({}),c=function(e){var n=s.useContext(i),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},u=function(e){var n=c(e.components);return s.createElement(i.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return s.createElement(s.Fragment,{},n)}},m=s.forwardRef((function(e,n){var t=e.components,a=e.mdxType,r=e.originalType,i=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),m=c(t),p=a,g=m["".concat(i,".").concat(p)]||m[p]||d[p]||r;return t?s.createElement(g,o(o({ref:n},u),{},{components:t})):s.createElement(g,o({ref:n},u))}));function p(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var r=t.length,o=new Array(r);o[0]=m;var l={};for(var i in n)hasOwnProperty.call(n,i)&&(l[i]=n[i]);l.originalType=e,l.mdxType="string"==typeof e?e:a,o[1]=l;for(var c=2;c<r;c++)o[c]=t[c];return s.createElement.apply(null,o)}return s.createElement.apply(null,t)}m.displayName="MDXCreateElement"},9944:function(e,n,t){"use strict";t.r(n),t.d(n,{frontMatter:function(){return l},contentTitle:function(){return i},metadata:function(){return c},toc:function(){return u},default:function(){return m}});var s=t(2122),a=t(9756),r=(t(7294),t(3905)),o=["components"],l={sidebar_position:2},i="Notions de base sur les interactions avec des contrats intelligents",c={unversionedId:"lesson-2/interact",id:"lesson-2/interact",isDocsHomePage:!1,title:"Notions de base sur les interactions avec des contrats intelligents",description:"Comme mentionn\xe9 pr\xe9c\xe9demment, les contrats intelligents sont des codes ex\xe9cutables. Dans les prochaines le\xe7ons, nous apprendrons \xe0 en \xe9crire un. En attendant, le mieux est d'utiliser les codes d\xe9j\xe0 \xe9crits pour garder les choses simples.",source:"@site/i18n/fr/docusaurus-plugin-content-docs-dev-academy/current/lesson-2/02-interact.md",sourceDirName:"lesson-2",slug:"/lesson-2/interact",permalink:"/fr/dev-academy/lesson-2/interact",editUrl:"https://crowdin.com/project/cosmwasm-docs/fr",version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"devAcademy",previous:{title:"Que sont les Smart Contracts / contrats intelligents ?",permalink:"/fr/dev-academy/lesson-2/what-is-smart-contracts"},next:{title:"D\xe9fi",permalink:"/fr/dev-academy/lesson-2/challenge"}},u=[{value:"O\xf9 trouver des contrats intelligents ?",id:"o\xf9-trouver-des-contrats-intelligents-",children:[]},{value:"T\xe9l\xe9charger",id:"t\xe9l\xe9charger",children:[]},{value:"Store (base de donn\xe9es)",id:"store-base-de-donn\xe9es",children:[]},{value:"Instanciation",id:"instanciation",children:[]}],d={toc:u};function m(e){var n=e.components,t=(0,a.Z)(e,o);return(0,r.kt)("wrapper",(0,s.Z)({},d,t,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"notions-de-base-sur-les-interactions-avec-des-contrats-intelligents"},"Notions de base sur les interactions avec des contrats intelligents"),(0,r.kt)("p",null,"Comme mentionn\xe9 pr\xe9c\xe9demment, les contrats intelligents sont des codes ex\xe9cutables. Dans les prochaines le\xe7ons, nous apprendrons \xe0 en \xe9crire un. En attendant, le mieux est d'utiliser les codes d\xe9j\xe0 \xe9crits pour garder les choses simples."),(0,r.kt)("h2",{id:"o\xf9-trouver-des-contrats-intelligents-"},"O\xf9 trouver des contrats intelligents ?"),(0,r.kt)("p",null,"Normalement, nous compilons les contrats intelligents en utilisant des compilateurs rust puis des optimisateurs de code. Maintenant, nous allons simplement t\xe9l\xe9charger un exemple pr\xe9compil\xe9 par l'\xe9quipe de cosmwasm."),(0,r.kt)("h2",{id:"t\xe9l\xe9charger"},"T\xe9l\xe9charger"),(0,r.kt)("p",null,"Nous fournissons l'ex\xe9cutable binaire du contrat intelligent dans le repo ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/CosmWasm/cw-plus/"},"cw-plus")," \xe0 c\xf4t\xe9 du code. Le repo cw-plus est une collection de contrats intelligents de qualit\xe9 production qui a \xe9t\xe9 fortement test\xe9e sur des r\xe9seaux r\xe9els. Vous verrez une liste des contrats disponibles sur la page du repo. Allez cliquer sur le bouton ",(0,r.kt)("strong",{parentName:"p"},"Releases")," pour voir les ex\xe9cutables binaires tagg\xe9s. Vous pouvez t\xe9l\xe9charger des binaires et les d\xe9ployer sur blockchains compatibles."),(0,r.kt)("p",null,"Nous utiliserons le binaire pr\xe9compil\xe9 cw20 pour ce cours : ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/CosmWasm/cw-plus/releases/download/v0.8.0/cw20_base.wasm"},"cw20-base")),(0,r.kt)("p",null,"Ne faites pas attention aux d\xe9tails de la base cw20, concentrez-vous sur le deploiement d'un contrat sur un testnet."),(0,r.kt)("h2",{id:"store-base-de-donn\xe9es"},"Store (base de donn\xe9es)"),(0,r.kt)("p",null,"Nous allons d\xe9ployer le code en utilisant le CLI ",(0,r.kt)("inlineCode",{parentName:"p"},"wasmd")," que nous avons install\xe9 pr\xe9c\xe9demment."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"curl -LJO https://github.com/CosmWasm/cw-plus/releases/download/v0.8.0/cw20_base.wasm\nRES=$(wasmd tx wasm store cw20_base.wasm --from wallet $TXFLAG -y)\n\n# get code id\nCODE_ID=$(echo $RES | jq -r '.logs[0].events[1].attributes[0].value')\n\n# print code id\necho $CODE_ID\n\n# no contracts yet, this should return an empty list\nwasmd query wasm list-contract-by-code $CODE_ID $NODE --output json\n\n")),(0,r.kt)("p",null,"Maintenant le code stock\xe9 sur le r\xe9seau. ",(0,r.kt)("inlineCode",{parentName:"p"},"CODE_ID")," est l'identifiant du code."),(0,r.kt)("h2",{id:"instanciation"},"Instanciation"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Le code du contrat intelligent != instance de contrat intelligent utilisable")),(0,r.kt)("p",null,"Le code d'un contrat intelligent n'est que la structure d'un contrat intelligent. Nous ",(0,r.kt)("em",{parentName:"p"},"instan\xe7ons")," un contrat intelligent bas\xe9 sur un code de contrat intelligent."),(0,r.kt)("p",null,"Voici le message d'instanciation :"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "nom" : "Golden Stars",\n  "symbol" : "STAR",\n  "d\xe9cimales" : "2",\n  "initial_balances" : [\n    {"adresse" : "wasm1ez03me7uljk7qerswdp935vlaa4dlu48mys3mq", "amount": "10000"},\n    {"adresse" : "wasm1tx7ga0lsnumd5hfsh2py0404sztnshwqaqjwy8", "montant" : "10000"},\n    {"adresse" : "wasm1mvjtezrn8dpateu0435trlw5062qy76gf738n0", "amount": "10000"}\n  ],\n  "mint" : {\n    "minter" : "addr"\n  } }.\n} }.\n')),(0,r.kt)("p",null,"Ce message contient l'\xe9tat initial du contrat."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'INIT=$(jq -n --arg wallet $(wasmd keys show -a wallet) \'{"name" : "Golden Stars", "symbol" : "STAR", "decimals":2, "initial_balances" :[{"address" :"wasm1n8aqd9jq9glhj87cn0nkmd5mslz3df8zm86hrh","amount":"10000"},{"address":"wasm13y4tpsgxza44yq76qvj69sakq4jmeyqudwgwpk","amount":"10000"},{"address":$wallet,"amount":"10000"}],"mint":{"minter":$wallet}\')\n\nwasmd tx wasm instantiate $CODE_ID "$INIT" --from wallet $TXFLAG --label "first cw20"\n')),(0,r.kt)("p",null,"Vous verrez cet output indiquant que la transaction d'instanciation est r\xe9ussie :"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "height" : "1350700",\n  "txhash" : "82D7240A35BDC6DE307AA725FE52590E83B60D4B682ABB0B0F6DCA28A66212D9",\n  "data": "0A3C0A0B696E7374616E7469617465122D0A2B7761736D3170657A74676C397661677768346B3574677765366E367475397338686A7779716D6C6D72686B",\n  "raw_log": "[{\\"events\\":[{\\"type\\":\\"message\\",\\"attributes\\":[{\\"key\\":\\"action\\",\\"value\\":\\"instantiate\\"},{\\"key\\":\\"module\\",\\"value\\":\\"wasm\\"},{\\"key\\":\\"signer\\",\\"value\\":\\"wasm10qhh60sexwtzd6nqr4r34z6t2d7nfrqp684twu\\"},{\\"key\\":\\"code_id\\",\\"value\\":\\"135\\"},{\\"key\\":\\"contract_address\\",\\"value\\":\\"wasm1peztgl9vagwh4k5tgwe6n6tu9s8hjwyqmlmrhk\\"}]},{\\"type\\":\\"wasm\\",\\"attributes\\":[{\\"key\\":\\"contract_address\\",\\"value\\":\\"wasm1peztgl9vagwh4k5tgwe6n6tu9s8hjwyqmlmrhk\\"}]}]}]",\n  "logs": [\n    {\n      "events" : [\n        {\n          "type" : "message",\n          "attributes" : [\n            {\n              "key" : "action",\n              "value" : "instancier"\n            },\n            {\n              "key" : "module",\n              "value" : "wasm"\n            },\n            {\n              "key" : "signer",\n              "value" : "wasm10qhh60sexwtzd6nqr4r34z6t2d7nfrqp684twu"\n            },\n            {\n              "key" : "code_id",\n              "value" : "135"\n            },\n            {\n              "key" : "contract_address",\n              "value" : "wasm1peztgl9vagwh4k5tgwe6n6tu9s8hjwyqmlmrhk"\n            }\n          ]\n        },\n        {\n          "type" : "wasm",\n          "attributes" : [\n            {\n              "key" : "adresse_contrat",\n              "value" : "wasm1peztgl9vagwh4k5tgwe6n6tu9s8hjwyqmlmrhk"\n            }\n          ]\n        } }\n      ]\n    }\n  ],\n  "gas_wanted" : "185650",\n  "gas_used" : "155257"\n} }.\n')),(0,r.kt)("p",null,"Nous avons maintenant d\xe9fini le but de cette le\xe7on. Vous savez maintenant \xe0 quoi ressemble l'interaction avec des contrats intelligents. Il existe bien s\xfbr d'autres moyens d'y parvenir, comme les clients CosmJS."),(0,r.kt)("p",null,"Nous nous arr\xeaterons ici, l'ex\xe9cution du contrat est le sujet d'un autre cours."))}m.isMDXComponent=!0}}]);